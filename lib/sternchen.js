// Generated by CoffeeScript 1.6.3
/*
    custom actano reporter (derived from the mocha tap reporter)
*/


(function() {
  var Sternchen;

  require('chai').Assertion.includeStack = true;

  Sternchen = (function() {
    function Sternchen(runner) {
      this.runner = runner;
      this.n = 1;
      this.passes = 0;
      this.failures = 0;
      this.initalizeEvents();
    }

    Sternchen.prototype.initalizeEvents = function() {
      var _this = this;
      this.runner.on('start', function() {
        var total;
        total = _this.runner.grepTotal(_this.runner.suite);
        return console.log('%d..%d', 1, total);
      });
      this.runner.on('test end', function() {
        return ++_this.n;
      });
      this.runner.on('pending', function(test) {
        return console.log('ok %d %s # SKIP -', _this.n, _this.title(test));
      });
      this.runner.on('pass', function(test) {
        _this.passes++;
        return console.log('ok %d %s', _this.n, _this.title(test));
      });
      this.runner.on('fail', function(test, err) {
        _this.failures++;
        console.log('mocha not ok %d %s', _this.n, _this.title(test));
        if (err.stack) {
          return console.log(err.stack.replace(/^/gm, '  '));
        }
      });
      return this.runner.on('end', function() {
        console.log('# tests ' + (_this.passes + _this.failures));
        console.log('# pass ' + _this.passes);
        return console.log('# fail ' + _this.failures);
      });
    };

    Sternchen.prototype.title = function(test) {
      return test.parent.fullTitle() + " : " + test.title;
    };

    return Sternchen;

  })();

  module.exports = Sternchen;

}).call(this);
